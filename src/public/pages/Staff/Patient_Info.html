<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Information - Medicis+</title>
    <link rel="stylesheet" href="/pages/Staff/patientInfo.css">
</head>
<body>
    <div class="container">
        <!-- Sidebar / Main Navigation -->
        <nav class="sidebar" aria-label="Main navigation">
            <div class="logo">
               <img src="/images/medicis_logo.png" alt="Medicis+ Logo">
               <span>Medicis+</span>
            </div>

            <div class="menu">
                <a class="menu-item active" href="/redirect/dashboard">
                    <span class="icon">üë•</span>
                    <span class="menu-text">Patients</span>
                </a>

                <a class="menu-item" href="/pages/Staff/Appointments.html">
                    <span class="icon">üìÖ</span>
                    <span class="menu-text">Appointments</span>
                </a>

                <a class="menu-item" href="/pages/Staff/manage_billing.html">
                    <span class="icon">üí≥</span>
                    <span class="menu-text">Billing</span>
                </a>
            </div>

            <div class="footer-menu">
                <a class="menu-item" href="./Support.html">
                    <span class="icon">‚ùì</span>
                    <span class="menu-text">Support</span>
                </a>

                <a class="menu-item" href="./MyAccount.html">
                    <span class="icon">üë§</span>
                    <div class="menu-labels">
                        <span class="menu-text">My Account</span>
                        <span class="staff-id" id="staff-id">Staff ID: 1234</span>
                    </div>
                </a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-inner">
                <header class="dashboard-header">
                    <h1>Dashboard</h1>
                    <p class="welcome-text">Welcome Back, <span class="doctor-name" id="staff-name">---</span></p>
                </header>

                <!-- Action Cards -->
                <div class="action-cards">
                    <div class="card search-card">
                        <h3>Search Patient</h3>
                        <label for="patient-id">Enter Patient ID:</label>
                        <div class="search-card-input-group">
                            <input type="number" id="search-id" placeholder="1234">
                            <button class="search-card-btn" type="button" onclick="search_id()">Search</button>
                        </div>
                    </div>
                    <div class="card diagnosis-card">
                        <h1><a href="/pages/Staff/Diagnosis.html" class="arrow-link" aria-label="Go to Diagnosis">DIAGNOSIS</a></h1>
                    </div>
                </div>

                <!-- Patient Information Section -->
                <section class="patient-info-section">
                    <h2>Patient Information</h2>
                    <div class="patient-card">
                        <div class="patient-details">
                            <div class="detail-row">
                                <label>Name:</label>
                                <span id="patient-name">----</span>
                                <span id="patient-name">--</span>
                            </div>
                            <div class="detail-row">
                                <label>ID:</label>
                                <span id="patient-id">---</span>
                            </div>
                            <div class="detail-row">
                                <label>Gender:</label>
                                <span id="patient-gender">----</span>
                            </div>
                            <div class="detail-row">
                                <label>Age:</label>
                                <span id="patient-age">----</span>
                            </div>
                            <div class="detail-row">
                                <label>Date of Birth:</label>
                                <span id="patient-birthday">----/--/--</span>
                            </div>
                            <div class="detail-row">
                                <label>Address :</label>
                                <span id="patient-address">----</span>
                            </div>
                            <div class="detail-row">
                                <label>Email :</label>
                                <span id="patient-email">----</span>
                            </div>
                            <div class="detail-row">
                                <label>Phone :</label>
                                <span id="patient-phone">----</span>
                            </div>
                        </div>
                        <div class="patient-avatar">
                            <div class="avatar-circle" aria-hidden="true"></div>
                        </div>
                    </div>
                    <button class="update-btn" type="button">Update Information</button>
                </section>

                <!-- Sign Out Button -->
                <div class="sign-out-container">
                    <button class="sign-out-btn" type="button" onclick="window.location.href = '/staff/logout'">Sign Out</button>
                </div>
            </div>
        </main>
    </div>
</body>
</html>

<script>
    window.onload = async ()=>{
       const query = await fetch("/staff/staff_info", {
            method: "GET"
       });

       const res = await query.json();

       if(res.success){
            document.getElementById("staff-id").innerHTML = "Staff ID: " + res.data.staff_id
            document.getElementById("staff-name").innerHTML = res.data.name
            return
       }
       alert(res.message)
    }

    async function search_id() {
        try{
            const query = await fetch("/staff/search-patient-id", {
                method: "POST",
                headers: {
                    "Content-type": "application/json"
                },
                body: JSON.stringify({ user_id: document.getElementById("search-id").value })
            });

            const res = await query.json();

            console.log(res)
            if(res.success){
                document.getElementById("patient-name").innerHTML = res.data.name;
                document.getElementById("patient-id").innerHTML = res.data.patient_id;
                document.getElementById("patient-gender").innerHTML = res.data.sex;
                document.getElementById("patient-age").innerHTML = res.data.age;
                document.getElementById("patient-birthday").innerHTML = res.data.date_of_birth;
                document.getElementById("patient-address").innerHTML = res.data.address;
                document.getElementById("patient-email").innerHTML = res.data.email;
                document.getElementById("patient-phone").innerHTML = res.data.phone;
                return
            }
            document.getElementById("patient-name").innerHTML = "----";
            document.getElementById("patient-id").innerHTML = "----";
            document.getElementById("patient-gender").innerHTML = "----";
            document.getElementById("patient-age").innerHTML = "----";
            document.getElementById("patient-birthday").innerHTML = "----/--/--";
            document.getElementById("patient-address").innerHTML = "----";
            document.getElementById("patient-email").innerHTML = "----";
            document.getElementById("patient-phone").innerHTML = "----";
            return
        }
        catch(err){
            alert(err);
        }
    }
</script>